(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84444,       2342]
NotebookOptionsPosition[     82335,       2266]
NotebookOutlinePosition[     82674,       2281]
CellTagsIndexPosition[     82631,       2278]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ccdata", "[", "7", "]"}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "/;", 
       RowBox[{"x", ">", "maxyx"}]}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0"}], "}"}]}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Define BWs", "Section",
 CellChangeTimes->{{3.72535801930616*^9, 3.72535802431168*^9}, {
  3.7253585975521927`*^9, 3.725358607310637*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BW", "[", 
    RowBox[{
    "w_", ",", "wr_", ",", "\[CapitalGamma]_", ",", "\[Delta]bg_", ",", 
     "const_", ",", "shift_", ",", "shift2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"const", 
     RowBox[{"(", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], "2"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w", "-", "wr"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], "2"]}]], ")"}]}], "+",
     " ", 
    RowBox[{"\[Delta]bg", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"w", "-", "wr"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w", "-", "wr"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], "2"]}]]}], "+", 
    RowBox[{"0", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"w", "-", "wr"}], ")"}], "2"]}], "-", " ", 
         SuperscriptBox["\[CapitalGamma]", "2"]}], ")"}], " ", 
       SuperscriptBox["deltabg", "2"]}], 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"w", "-", "wr"}], ")"}], "2"]}], "+", 
       SuperscriptBox["\[CapitalGamma]", "2"]}]]}], "+", 
    RowBox[{"shift", " ", 
     RowBox[{"(", 
      RowBox[{"w", "-", "wr"}], ")"}]}], "+", "shift2"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BWi", "[", 
    RowBox[{"w_", ",", "wr_", ",", "\[CapitalGamma]_", ",", "const_"}], "]"}],
    ":=", 
   RowBox[{"const", 
    RowBox[{"(", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"w", "-", "wr"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[CapitalGamma]", "/", "2"}], ")"}], "2"]}]], ")"}]}]}], 
  " ", ";"}]}], "Input",
 CellChangeTimes->{{3.725011819995084*^9, 3.725011822739936*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Charmonium", "Section",
 CellChangeTimes->{{3.725358029993801*^9, 3.725358039838393*^9}}],

Cell[CellGroupData[{

Cell["Import Data", "Subsection",
 CellChangeTimes->{{3.725358042278319*^9, 3.725358055245266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tscanc", "=", 
   RowBox[{"{", 
    RowBox[{
    "150", ",", "153", ",", "156", ",", "159", ",", "162", ",", "165", ",", 
     "168", ",", "171", ",", "174", ",", "177", ",", "180", ",", "183", ",", 
     "186", ",", "189", ",", "192", ",", "194", ",", "197", ",", "200", ",", 
     "204", ",", "207", ",", "210", ",", "213", ",", "216", ",", "218", ",", 
     "221", ",", "224", ",", "227", ",", "230", ",", "234", ",", "237", ",", 
     "240", ",", "243", ",", "246", ",", "249"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726817525311737*^9, 3.726817526071261*^9}, 
   3.726817563192273*^9, {3.726817607668054*^9, 3.7268176243209267`*^9}, {
   3.726817751948346*^9, 3.726817832627799*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ccdata", "[", "n", "]"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<spectraldata/Tscan/cc/swccT\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Tscanc", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}], "<>", 
        "\"\<spectra.dat\>\""}], "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{"Length", "[", "Tscanc", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"ccdata", "[", "n", "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{"Length", "[", "Tscanc", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.725358141297976*^9, 3.725358229741619*^9}, {
  3.726381203252303*^9, 3.72638122981116*^9}, {3.726817443686364*^9, 
  3.726817450558557*^9}, {3.7268175034474773`*^9, 3.7268175195436897`*^9}, {
  3.726817549624247*^9, 3.726817584073985*^9}, {3.726817645844924*^9, 
  3.726817661849916*^9}, {3.7268178518132267`*^9, 3.726817853316984*^9}, {
  3.726818220884605*^9, 3.726818248043754*^9}, {3.726818395112039*^9, 
  3.726818405030871*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 1, 34, 1}}, Typeset`size$$ = {
    360., {104., 110.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`n$27308$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$27308$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        $CellContext`ccdata[$CellContext`n$$], Joined -> True], 
      "Specifications" :> {{$CellContext`n$$, 1, 34, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {148., 155.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.726824276224249*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting", "Subsection",
 CellChangeTimes->{{3.7253580702221193`*^9, 3.725358078577265*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ccmodel", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "[", "Tscanc", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "ccmodel", "]"}], ";"}], "\n", 
 RowBox[{"ParallelDo", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"ccmodel", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], ",", "maxx", ",", "minx", ",", 
       "maxy", ",", "maxyx", ",", "maxyi", ",", "maxxy", ",", "inter", ",", 
       "maxxs", ",", "maxxis", ",", "maxys", ",", "mins", ",", "hwhmi", ",", 
       "gammas", ",", "ccdatac", ",", "bad"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxx", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"ccdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minx", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"ccdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxy", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"ccdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxyx", "=", 
       RowBox[{
        RowBox[{"ccdata", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"ccdata", "[", "n", "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"ccdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
           
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"maxyi", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ccdata", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "maxyx"}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"maxxy", "=", 
       RowBox[{
        RowBox[{"ccdata", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"ccdata", "[", "n", "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"ccdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
           
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"inter", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ccdata", "[", "n", "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", "\n", 
      RowBox[{"maxxs", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicatesBy", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"FindMaxValue", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"inter", "[", "x", "]"}], ",", 
                    RowBox[{
                    "maxyx", "\[LessEqual]", "x", "\[LessEqual]", "maxx"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "a"}], "}"}]}], "]"}], ",", "maxxy"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"FindArgMax", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"inter", "[", "x", "]"}], ",", 
                    RowBox[{
                    "maxyx", "\[LessEqual]", "x", "\[LessEqual]", "maxx"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "a"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "maxyx", ",", "maxx", ",", 
                FractionBox[
                 RowBox[{"maxx", "-", "maxyx"}], "50"]}], "}"}]}], "]"}], ",",
             "First"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxxis", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ccdata", "[", "n", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ccdata", "[", "n", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"maxxs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"maxys", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ccdata", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"maxxis", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bad", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"maxys", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", 
            RowBox[{"maxys", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"bad", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"bad", ",", "i"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "[", "maxys", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], "\n", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxxs", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"maxxs", ",", 
             RowBox[{"bad", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{"maxys", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"maxys", ",", 
             RowBox[{"bad", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{"maxxis", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"maxxis", ",", 
             RowBox[{"bad", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "bad", "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "maxxs", "]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mins", "=", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Length", "[", "maxxs", "]"}], "-", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mins", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ccdata", "[", "n", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"ccdata", "[", "n", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"maxxis", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ";;", 
                    RowBox[{"maxxis", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", "2"}], 
                   "]"}], "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"Length", "[", "maxxs", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"mins", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"mins", ",", 
               RowBox[{
                RowBox[{"maxxis", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mins", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"maxxis", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"maxxis", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"maxxis", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"mins", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], 
                "\[LessEqual]", " ", 
                RowBox[{"Length", "[", 
                 RowBox[{"ccdata", "[", "n", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"maxxis", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "+", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"maxxis", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"mins", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
               RowBox[{"Length", "[", 
                RowBox[{"ccdata", "[", "n", "]"}], "]"}]}], "]"}]}], "]"}]}], 
          ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"hwhmi", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"ccdata", "[", "n", "]"}], ",", 
              RowBox[{
               RowBox[{"Nearest", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ccdata", "[", "n", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{";;", "maxyi"}], ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"maxy", "/", "2"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mins", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"maxyi", "-", 
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{"maxyi", "-", "hwhmi"}], ")"}]}]}], ",", 
             RowBox[{"maxyi", "+", 
              RowBox[{"3", 
               RowBox[{"(", 
                RowBox[{"maxyi", "-", "hwhmi"}], ")"}]}]}]}], "}"}]}], 
          ";"}]}], "]"}]}], ";", "\n", 
      RowBox[{"hwhmi", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "maxxs", "]"}], "]"}]}], ";", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"hwhmi", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"ccdata", "[", "n", "]"}], ",", 
            RowBox[{
             RowBox[{"Nearest", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ccdata", "[", "n", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mins", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ";;", 
                   RowBox[{"maxxis", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "2"}], "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"inter", "[", 
                 RowBox[{"maxxs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "/", "2"}]}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"ccdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"hwhmi", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], ",", "2"}], "]"}], 
               "]"}]}], "\[LessEqual]", 
             RowBox[{"0.5", " ", 
              RowBox[{"maxys", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"ccdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"hwhmi", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], ",", "2"}], "]"}], 
               "]"}]}], "\[GreaterEqual]", 
             RowBox[{"1.5", " ", 
              RowBox[{"maxys", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"hwhmi", "[", 
            RowBox[{"[", 
             RowBox[{"-", "i"}], "]"}], "]"}], "=", 
           RowBox[{"maxxis", "[", 
            RowBox[{"[", 
             RowBox[{"-", "i"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"Length", "[", "hwhmi", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"hwhmi", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"maxxis", "-", "hwhmi"}], ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"gammas", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "hwhmi", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gammas", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"maxxs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"ccdata", "[", "n", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"maxxis", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"hwhmi", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", "1"}], "]"}], "]"}]}],
            ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "hwhmi", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      
      RowBox[{"ccdatac", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "maxxs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ccdatac", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"ccdata", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"mins", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ";;", 
            RowBox[{"mins", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ccmodel", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "hwhmi", "]"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{
           RowBox[{"ccdatac", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"BW", "[", 
              RowBox[{
              "w", ",", "wr", ",", "\[CapitalGamma]", ",", "\[Delta]bg", ",", 
               "const", ",", "shift", ",", "shift2"}], "]"}], ",", 
             RowBox[{"const", ">", "0"}], ",", 
             RowBox[{"\[CapitalGamma]", ">", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"wr", ",", 
               RowBox[{"maxxs", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalGamma]", ",", 
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"const", ",", 
               RowBox[{"maxys", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Delta]bg", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"shift", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"shift2", ",", "0.0"}], "}"}]}], "}"}], ",", "w"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "hwhmi", "]"}]}], "}"}]}], "]"}], ";"}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7250168129484653`*^9, 3.7250168395302067`*^9}, 
   3.7250169477770243`*^9, {3.725016986405937*^9, 3.7250169871938963`*^9}, {
   3.7250171453879147`*^9, 3.7250171636018257`*^9}, {3.725020649579236*^9, 
   3.725020650938236*^9}, 3.7251870520612803`*^9, {3.725189773391038*^9, 
   3.725189775615027*^9}, {3.725189825776582*^9, 3.725189829345358*^9}, {
   3.72519008468959*^9, 3.7251901038497667`*^9}, {3.725192986511909*^9, 
   3.725192989113798*^9}, {3.725193119745401*^9, 3.725193132066327*^9}, {
   3.725193440304281*^9, 3.725193441917924*^9}, {3.7252752776883907`*^9, 
   3.725275281588447*^9}, {3.7268179861480093`*^9, 3.726817990801214*^9}, {
   3.726818095257213*^9, 3.726818097840543*^9}, 3.726818170136559*^9, {
   3.726818261852936*^9, 3.726818294113308*^9}, {3.726818572998138*^9, 
   3.726818573793661*^9}, {3.726822919949441*^9, 3.726822920754781*^9}, {
   3.7268237516318903`*^9, 3.726823762127667*^9}, {3.726823850625949*^9, 
   3.726823858025086*^9}, {3.726823916092051*^9, 3.7268239385465517`*^9}, {
   3.726825097527788*^9, 3.726825110960245*^9}, {3.726826462383067*^9, 
   3.72682647073528*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsection",
 CellChangeTimes->{{3.7253580978611917`*^9, 3.725358116881402*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParallelDo", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"ccmodel", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "2"}], ",", 
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{";;", "2"}]}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"ccmodel", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
        RowBox[{"ccTcut", "=", "i"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"wrfitcc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "ccmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wrfitcc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"ccmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"wrfitcc", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"wr", "/.", 
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"wrfitcc", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "wrfitcc", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalGamma]fitcc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "ccmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]fitcc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"ccmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]fitcc", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"\[CapitalGamma]", "/.", 
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"\[CapitalGamma]fitcc", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "\[CapitalGamma]fitcc", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"constfitcc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "ccmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"constfitcc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"ccmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"constfitcc", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"const", "/.", 
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"constfitcc", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "constfitcc", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areafitcc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "ccmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"areafitcc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"ccmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "ccmodel", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"areafitcc", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
      RowBox[{
       FractionBox["\[Pi]", "2"], " ", 
       RowBox[{"constfitcc", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], " ", 
       RowBox[{"\[CapitalGamma]fitcc", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"areafitcc", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "areafitcc", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7251730891229553`*^9, 3.725173094983835*^9}, {
   3.725173272655423*^9, 3.7251732805514793`*^9}, {3.725173350795*^9, 
   3.725173413425877*^9}, {3.725173467793077*^9, 3.725173470814598*^9}, 
   3.7251735935001373`*^9, {3.725173783270134*^9, 3.72517379187675*^9}, 
   3.725358521929027*^9, {3.725358778796464*^9, 3.725358870151351*^9}, {
   3.7253589451252193`*^9, 3.72535895049085*^9}, {3.725361185263607*^9, 
   3.72536119100323*^9}, {3.726821905018765*^9, 3.7268219064257097`*^9}, 
   3.726822003774082*^9, {3.726822145373521*^9, 3.7268221817260637`*^9}, 
   3.7268267850043592`*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"ccdata", "[", "i", "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ccmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"0.7", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{
           RowBox[{"1.3", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"BWi", "[", 
         RowBox[{"x", ",", 
          RowBox[{"wr", "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"\[CapitalGamma]", "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"const", "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"0.7", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{
           RowBox[{"1.3", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"ccmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Green", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ccmodel", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"ccmodel", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.725018906220598*^9, 3.725019110591589*^9}, {
  3.725019211801218*^9, 3.725019213160674*^9}, {3.725019468691352*^9, 
  3.725019542662833*^9}, {3.7250195833383083`*^9, 3.7250196093119087`*^9}, {
  3.7250197504957047`*^9, 3.725019768253553*^9}, {3.725020661321162*^9, 
  3.725020757760775*^9}, {3.725021003443694*^9, 3.7250210491369047`*^9}, {
  3.725021133320426*^9, 3.725021140462159*^9}, {3.725172852224782*^9, 
  3.7251728542018414`*^9}, {3.725182456719808*^9, 3.725182480073546*^9}, {
  3.72518760640889*^9, 3.725187608717104*^9}, {3.725188770874642*^9, 
  3.7251887878960667`*^9}, {3.726822327067115*^9, 3.7268223273311653`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["ccTcut"], "Input",
 CellChangeTimes->{{3.7268280971826477`*^9, 3.726828098459949*^9}}],

Cell[BoxData["19"], "Output",
 CellChangeTimes->{3.726828099058777*^9, 3.726828457968581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"Tscanc", ",", 
       RowBox[{"wrfitcc", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tscanc", "[", 
        RowBox[{"[", 
         RowBox[{";;", "ccTcut"}], "]"}], "]"}], ",", 
       RowBox[{"wrfitcc", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{";;", "ccTcut"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
     "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.726827633847341*^9, 3.726827636859535*^9}, {
  3.726827677669911*^9, 3.726827709286421*^9}, {3.726827935822178*^9, 
  3.726827951268824*^9}, {3.726828005340424*^9, 3.726828011491425*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQYHkhzyP6lrax3hcADzFZIdNh1e5rJ2P5TfkOxw
+9vtIwy7oPwHyQ7fpl1c3LsZyndIcXCXjc7oWwPlL0hx+P583myNpVA+Q6rD
jUe8r0rnQvkJqQ48bDP5OqdC+QdSHRZ8mjIjvxdmf5rDhObfl41bYfanOezv
ssu4WwOzP82B3ycksqgEZn+6Q2LlvLPfsmH2pzs0hPjvzEuG2Z/h8GCe9ZPb
UTD1GQ4F+5cutg+Cqc9w8PjAv3C2J0x9psPfpYa8Hxxg9mc6mFSuN6qygNmf
6XCDq3ZtkgHMvCyH+1MNZRw0YOZlOciU54lzKcDMy3aoyDa8dFwcpj7bYWVr
4dxsfpj6bIes2B9XGNlh6nMcMnbctar4xw4NrxwHDdkDi89+hfIP5Dis1ynS
+fQGynfIdXjwuXDSycdQ/oJch2rNpQIfHkH5DHkOFUEPCgRuw8zLc5BcuHei
wWWYeXkO/162inmfhvIV8h306r5fSjjM7gAAzNOZmA==
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQYHkhzUl3Q7nI7ldQDzFZId7H8V7c2xhPIbkh1y
XR07Uvih/AfJDrV8cmqpj3ggfIcUh0fvDve0b4byF6Q4CK07u0SjGcpnSHWw
1XnupxIE5SekOsjPWX7/tTKUfyDVgWFv0w6PL9xQ+9McmlduD8g5BuU3pDl0
lQVZac2C8h+kOSzNEglnzIfyHdIdVsUvEz7nAuUvSHe4+C3m8XZpKJ8hw2Fp
xULr3C9cUPUZDi6/+Hs3XYDyF2Q4/GwSFN+2H8pnyHQoC5nr+G0DlN+Q6eAu
e7gqbAmXAwCB6lNA
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{148.45312500000003`, 2.935379605649664},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->{729., Automatic},
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{150., 249.}, {2.9703995210436664`, 3.6707978289237135`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.726827682824684*^9, 3.726827710033073*^9}, {
   3.726827953267959*^9, 3.726827967577446*^9}, 3.7268280122590513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"Tscanc", ",", 
       RowBox[{"\[CapitalGamma]fitcc", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tscanc", "[", 
        RowBox[{"[", 
         RowBox[{";;", "ccTcut"}], "]"}], "]"}], ",", 
       RowBox[{"\[CapitalGamma]fitcc", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{";;", "ccTcut"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
     "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.726828265552346*^9, 3.7268282749523783`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQYHkhxCNz9cp5dtaQ/mKyQ7vC9SWFa1KgbCb0h2
eLI86M/CvXkQ/oNkh3WyPbIXGyshfIcUh2iN9faXa5og/AUpDqfU/R01LnRA
+AypDifMImwyO/oh/IRUh1tZQpNfO0+G8A+kOixpCS5R5ZoOtT/N4a1yqX7P
x1lQ+9Mcrq9cM/nPt3lQ+9Mc9KJXcjN2L4Tan+4QKetnG7B+MdT+dIcDzBvm
/Tq2FGp/hoPii+jTv34vh6rPcHj2Mlc6xmkVVH2Gw9MFh82VO9ZA1Wc6XJj/
3HjSnXVQ+zMdLjJsWbSxbwPU/kyH6SsaFVRWb4Sal+WQ7bzgctShTVDzshye
MNRJlL/bDDUv22HSdYlqRuGtUPXZDrt6JJwy7bZB1Wc7uJq6LcrP2Q5Vn+Og
+Jxv6tVpO6DhleMglnhBPe3qTmh45TjcNlkfsph5N9S8XIcLFgerlljugZqX
69B+TbXxkc0+qHl5DnsFnX2WduyHmpfnkHq5jJs3/wDUvDyHFalbViYpHISG
f75Dz7bZt8tPHLQHAJVfqUc=
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQYHkhwOvRQ+uCghxR7MV0h2UM9sWOR8qw3Cb0h2
iJgY1ZC1cDqE/yDZYSFngtESvcUQvkOKw/T9/66ITlgN4S9IcWAMFeF5GbgJ
wmdIdTgVue7YJebtEH5CqkNajGT2+ozdEP6BVAcPFZZETvaDUPvTHBiVOqRW
dxyB2p/mcKI4QG0/zwmo/WkOZhax0cLZp6H2pztMOne5mq/rHNT+dAcFk74Z
aosvQO3PcMgWKoneeO4iVH2Gw6RtJ08sP3kJqj7DoTTsz6RDHy5D1Wc6nP3A
c15U+CrU/kyHR/LVVg+1rtkDAPFiXBg=
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{148.45312500000003`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->{734., Automatic},
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{150., 249.}, {0, 0.34636717520743165`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.726828275639574*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"Tscanc", ",", 
       RowBox[{"areafitcc", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tscanc", "[", 
        RowBox[{"[", 
         RowBox[{";;", "ccTcut"}], "]"}], "]"}], ",", 
       RowBox[{"areafitcc", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{";;", "ccTcut"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
     "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.726828330441535*^9, 3.7268283346169252`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw10Fsog2EcBvAv5cJGajmUYt92tRtuHBLhKUzaBZGyG8Z8s/lmCzeW0ooW
EaIcVuZLuSIakhRZDlPmwpnNYUu4IZFQNMe/t97efvX0PPXKqs0lXAjDMPLv
+/P+ntVqdLptviFPIOfXrBaxT7mJ4kmyVQu7ecbGtJP9WsQf375tqsmoQRqP
bFsiWajBaIb4OZQhMxzCWjvixnb9f9ZweMxf+egeJ69yeCkq3XltJLM6dHpU
PaJcslWHvOXh9SkJ2a/D63ax27t2Sfu1sPKyNkUVWaiFk73aUAYvaF8P+YHI
eTJChh4LareqJYUs6CFq0iZP7JxT3gB10t6sWke2GuBS5sQMfp7RvgEJDbKm
eAcZdbizT10HMslCHTzNnpvpIx/18SgOL/NJG8ngwY4onrtEZIGHdK03dWnC
S3kjSioH/NIsssYIV/iWJfrwlP7LiIe9wvtbAxn1iGhfWqh4OaG+enCSgvf9
yP8+EyYt8665DcprTOhT9cvaWv/7TEhedLxb0smsGUFFuTPqu+8LB2Gz1w==

      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQYHkhxUfpjw7l17wR7MV0h2uLM8c8PuJech/IZk
h549z/pfLzgL4T9Idjh6wGQxW/RpCN8hxcEt8EdZ38kTEP6CFIeLlY0ur+8c
hfAZUh12qrOzPt56CMJPSHUISi2d8j9yP4R/INVhj17x2cuT9kDtT3NYvSpM
SenCTqj9aQ5l/y/+uL1rG9T+NAdd95255zk3Q+1Pd8ivi35/K2wt1P50h/sP
5V9aVi+G2p/h8DCLbZlh1SSo+gyHu8n9iWlOHFD1GQ7qDgycP9Qv20HUZzps
WPTXX8z7EoTfkOngZMNhPqv0uh0AMr9jHw==
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{148.45312500000003`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->{735., Automatic},
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{150., 249.}, {0, 0.5562247550608258}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.726828335118822*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Emission Rates", "Subsection",
 CellChangeTimes->{{3.72535868730585*^9, 3.7253587004670477`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Emfactor", "=", "2.068897721078438`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nB", "[", 
    RowBox[{"w_", ",", "T_"}], "]"}], ":=", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      FractionBox["w", "T"], "]"}], "-", "1"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.725358704474215*^9, 3.725358721357132*^9}, {
  3.725361472835392*^9, 3.72536148156748*^9}, {3.725362776143972*^9, 
  3.725362777094586*^9}, {3.726826848079886*^9, 3.726826849759956*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "ccTcut"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"R0", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tscanc", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"Emfactor", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"areafitcc", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "2"}], "]"}], "]"}], 
           RowBox[{"nB", "[", 
            RowBox[{
             RowBox[{"wrfitcc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Tscanc", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "/", "1000"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"areafitcc", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "1"}], "]"}], "]"}], 
           RowBox[{"nB", "[", 
            RowBox[{
             RowBox[{"wrfitcc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Tscanc", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "/", "1000"}]}], "]"}]}], 
          ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "ccTcut"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.725361225914867*^9, 3.7253613103526297`*^9}, {
  3.725361342615449*^9, 3.725361363368341*^9}, {3.725361486279459*^9, 
  3.7253615682605352`*^9}, {3.725362762652525*^9, 3.72536276293797*^9}, {
  3.725362868989019*^9, 3.725362900512672*^9}, {3.726826853448038*^9, 
  3.726826891448366*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "R0", "]"}]], "Input",
 CellChangeTimes->{{3.7253628902186813`*^9, 3.7253628905569153`*^9}, {
  3.726826898081106*^9, 3.726826965465569*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQYHkhzmV/zpm1k51R7MV0h22GVnt2Vi3QwIvyHZ
ISDHtX/d+dkQ/oNkB3WPghdb1OdD+A4pDtf2VV33FFsI4S9IcbjX5pr31mAR
hM+Q6hDOfvRK3CYoPyHVwfvMBi3Obij/QKrDC98fL0/9WAy1P80hUUIo2Epq
KdT+NIejCfcurO2A8h+kObzce2nNrP1LoPanO9ieDXtT5wo1b0G6w9YtZhEf
uqHuZchwyMoUYynL7YWqz3BYd8q7el4QK1R9hoNo3eF6s1sX7SDqMx2MX55n
uPUFym/IdNgeGSrX5n3DDgAgTWHe
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{149.15625, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{150., 204.}, {0, 0.04205840277353582}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7253628910240297`*^9, 3.725362902951058*^9}, {
  3.726826895263213*^9, 3.726826923421838*^9}, {3.726826953816105*^9, 
  3.7268269661631727`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bottomonium", "Section",
 CellChangeTimes->{{3.725358472668298*^9, 3.72535848844833*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bbdata", "[", "n", "]"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/davidlafferty/Projects/master/spectraldata/swbbT\>\"", "<>", 
        RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<spectra.dat\>\""}], 
       "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "7"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"bbdata", "[", "n", "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "2", ",", "7", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7253585482434473`*^9, 3.725358561835896*^9}}],

Cell[CellGroupData[{

Cell["Fitting", "Subsection",
 CellChangeTimes->{{3.725358578419651*^9, 3.725358590341634*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bbmodel", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "7"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"bbmodel", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], ",", "maxx", ",", "minx", ",", 
       "maxy", ",", "maxyx", ",", "maxyi", ",", "maxxy", ",", "inter", ",", 
       "maxxs", ",", "maxxis", ",", "maxys", ",", "mins", ",", "hwhmi", ",", 
       "gammas", ",", "bbdatac"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxx", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"bbdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minx", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"bbdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxy", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"bbdata", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxyx", "=", 
       RowBox[{
        RowBox[{"bbdata", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"bbdata", "[", "n", "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"bbdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
           
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"maxyi", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bbdata", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "maxyx"}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"maxxy", "=", 
       RowBox[{
        RowBox[{"bbdata", "[", "n", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"bbdata", "[", "n", "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"bbdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
           
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"inter", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"bbdata", "[", "n", "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", "\n", 
      RowBox[{"maxxs", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicatesBy", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"FindMaxValue", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"inter", "[", "x", "]"}], ",", 
                    RowBox[{
                    "maxyx", "\[LessEqual]", "x", "\[LessEqual]", "maxx"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "a"}], "}"}]}], "]"}], ",", "maxxy"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"FindArgMax", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"inter", "[", "x", "]"}], ",", 
                    RowBox[{
                    "maxyx", "\[LessEqual]", "x", "\[LessEqual]", "maxx"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "a"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "maxyx", ",", "maxx", ",", 
                FractionBox[
                 RowBox[{"maxx", "-", "maxyx"}], "20"]}], "}"}]}], "]"}], ",",
             "First"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxxis", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bbdata", "[", "n", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bbdata", "[", "n", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"maxxs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"maxys", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bbdata", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"maxxis", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "maxxs", "]"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mins", "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "[", "maxxs", "]"}], "-", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mins", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bbdata", "[", "n", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"bbdata", "[", "n", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"maxxis", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ";;", 
                    RowBox[{"maxxis", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", "2"}], 
                  "]"}], "]"}], "]"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"Length", "[", "maxxs", "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mins", "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"mins", ",", 
              RowBox[{
               RowBox[{"maxxis", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"mins", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"maxxis", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ",", 
            
            RowBox[{
             RowBox[{"maxxis", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"maxxis", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "-", 
               RowBox[{"mins", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hwhmi", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"bbdata", "[", "n", "]"}], ",", 
             RowBox[{
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bbdata", "[", "n", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{";;", "maxyi"}], ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"maxy", "/", "2"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mins", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"maxyi", "-", 
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"maxyi", "-", "hwhmi"}], ")"}]}]}], ",", 
            RowBox[{"maxyi", "+", 
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"maxyi", "-", "hwhmi"}], ")"}]}]}]}], "}"}]}], ";"}]}],
        "]"}], ";", "\n", 
      RowBox[{"hwhmi", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "maxxs", "]"}], "]"}]}], ";", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"hwhmi", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"bbdata", "[", "n", "]"}], ",", 
            RowBox[{
             RowBox[{"Nearest", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bbdata", "[", "n", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mins", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ";;", 
                   RowBox[{"maxxis", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "2"}], "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"inter", "[", 
                 RowBox[{"maxxs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "/", "2"}]}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"bbdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"hwhmi", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], ",", "2"}], "]"}], 
               "]"}]}], "\[LessEqual]", 
             RowBox[{"0.5", " ", 
              RowBox[{"maxys", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{
               RowBox[{"bbdata", "[", "n", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"hwhmi", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "i"}], "]"}], "]"}], ",", "2"}], "]"}], 
               "]"}]}], "\[GreaterEqual]", 
             RowBox[{"1.5", " ", 
              RowBox[{"maxys", "[", 
               RowBox[{"[", 
                RowBox[{"-", "i"}], "]"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"hwhmi", "[", 
            RowBox[{"[", 
             RowBox[{"-", "i"}], "]"}], "]"}], "=", 
           RowBox[{"maxxis", "[", 
            RowBox[{"[", 
             RowBox[{"-", "i"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"Length", "[", "hwhmi", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"hwhmi", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"maxxis", "-", "hwhmi"}], ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"gammas", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "hwhmi", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gammas", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"maxxs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"bbdata", "[", "n", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"maxxis", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"hwhmi", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", "1"}], "]"}], "]"}]}],
            ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "hwhmi", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      
      RowBox[{"bbdatac", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "maxxs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bbdatac", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"bbdata", "[", "n", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"mins", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ";;", 
            RowBox[{"mins", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "maxxs", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bbmodel", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "hwhmi", "]"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bbmodel", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{
           RowBox[{"bbdatac", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"BW", "[", 
              RowBox[{
              "w", ",", "wr", ",", "\[CapitalGamma]", ",", "\[Delta]bg", ",", 
               "const", ",", "shift", ",", "shift2"}], "]"}], ",", 
             RowBox[{"const", ">", "0"}], ",", 
             RowBox[{"\[CapitalGamma]", ">", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"wr", ",", 
               RowBox[{"maxxs", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalGamma]", ",", 
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"const", ",", 
               RowBox[{"maxys", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Delta]bg", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"shift", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"shift2", ",", "0.0"}], "}"}]}], "}"}], ",", "w"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "hwhmi", "]"}]}], "}"}]}], "]"}], ";"}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Length", "[", "bbmodel", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.725020788434743*^9, 3.7250207889305277`*^9}, 
   3.7251870199591017`*^9, {3.725188367199911*^9, 3.725188394220587*^9}, 
   3.725189751985444*^9, {3.725190053886017*^9, 3.7251900704637938`*^9}, {
   3.725275651522296*^9, 3.725275656764453*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsection",
 CellChangeTimes->{{3.725358615447584*^9, 3.7253586227029257`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wrfitbb", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "bbmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wrfitbb", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"bbmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "bbmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"wrfitbb", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"wr", "/.", 
        RowBox[{
         RowBox[{"bbmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"wrfitbb", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "wrfitbb", "]"}]}], "}"}]}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]fitbb", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "bbmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]fitbb", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"bbmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "bbmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]fitbb", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"\[CapitalGamma]", "/.", 
        RowBox[{
         RowBox[{"bbmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"\[CapitalGamma]fitbb", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "\[CapitalGamma]fitbb", "]"}]}], "}"}]}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constfitbb", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "bbmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"constfitbb", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"bbmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "bbmodel", "]"}]}], "}"}]}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"constfitbb", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
       RowBox[{"const", "/.", 
        RowBox[{
         RowBox[{"bbmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"constfitbb", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "constfitbb", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areafitbb", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "bbmodel", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"areafitbb", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"bbmodel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "bbmodel", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"areafitbb", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "ii"}], "]"}], "]"}], "=", 
      RowBox[{
       FractionBox["\[Pi]", "2"], " ", 
       RowBox[{"constfitbb", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}], " ", 
       RowBox[{"\[CapitalGamma]fitbb", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "ii"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"areafitbb", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "areafitbb", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7251730891229553`*^9, 3.725173094983835*^9}, {
   3.725173272655423*^9, 3.7251732805514793`*^9}, {3.725173350795*^9, 
   3.725173413425877*^9}, {3.725173467793077*^9, 3.725173470814598*^9}, 
   3.7251735935001373`*^9, {3.725173783270134*^9, 3.72517379187675*^9}, {
   3.725173880379524*^9, 3.725173882198493*^9}, {3.7251790832679157`*^9, 
   3.725179085029264*^9}, 3.725358627911529*^9, {3.725358884543461*^9, 
   3.725358927033409*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"bbdata", "[", 
         RowBox[{"i", "+", "1"}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bbmodel", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"0.7", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{
           RowBox[{"1.3", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"BWi", "[", 
         RowBox[{"x", ",", 
          RowBox[{"wr", "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"\[CapitalGamma]", "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{"const", "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"0.7", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}], ",", 
          RowBox[{
           RowBox[{"1.3", " ", "wr"}], "/.", 
           RowBox[{
            RowBox[{"bbmodel", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "ii"}], "]"}], "]"}], "[", 
            "\"\<BestFitParameters\>\"", "]"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Green", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "bbmodel", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"bbmodel", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7251827518992577`*^9, 3.725182753516506*^9}, {
  3.725188542604348*^9, 3.7251886388289223`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1019},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 422, 14, 34, "Input"],
Cell[983, 36, 167, 4, 34, "Input"],
Cell[CellGroupData[{
Cell[1175, 44, 144, 2, 65, "Section"],
Cell[1322, 48, 2412, 77, 143, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3771, 130, 95, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[3891, 135, 99, 1, 45, "Subsection"],
Cell[3993, 138, 734, 13, 34, "Input"],
Cell[CellGroupData[{
Cell[4752, 155, 1302, 32, 57, "Input"],
Cell[6057, 189, 1607, 33, 320, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7713, 228, 97, 1, 45, "Subsection"],
Cell[7813, 231, 20967, 547, 807, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28817, 783, 97, 1, 44, "Subsection"],
Cell[28917, 786, 6971, 211, 436, "Input"],
Cell[35891, 999, 3821, 95, 103, "Input"],
Cell[CellGroupData[{
Cell[39737, 1098, 100, 1, 32, "Input"],
Cell[39840, 1101, 93, 1, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39970, 1107, 839, 23, 34, "Input"],
Cell[40812, 1132, 2571, 54, 468, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43420, 1191, 723, 21, 34, "Input"],
Cell[44146, 1214, 2497, 54, 461, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46680, 1273, 701, 21, 34, "Input"],
Cell[47384, 1296, 2475, 54, 465, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49908, 1356, 103, 1, 44, "Subsection"],
Cell[50014, 1359, 536, 14, 86, "Input"],
Cell[50553, 1375, 1851, 51, 57, "Input"],
Cell[CellGroupData[{
Cell[52429, 1430, 181, 3, 32, "Input"],
Cell[52613, 1435, 1852, 42, 234, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54526, 1484, 95, 1, 65, "Section"],
Cell[54624, 1487, 791, 22, 57, "Input"],
Cell[CellGroupData[{
Cell[55440, 1513, 95, 1, 45, "Subsection"],
Cell[55538, 1516, 17450, 468, 715, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73025, 1989, 97, 1, 44, "Subsection"],
Cell[73125, 1992, 5864, 179, 368, "Input"],
Cell[78992, 2173, 3315, 89, 125, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

