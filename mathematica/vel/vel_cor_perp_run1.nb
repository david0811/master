(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49945,       1363]
NotebookOptionsPosition[     48587,       1312]
NotebookOutlinePosition[     48945,       1328]
CellTagsIndexPosition[     48902,       1325]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7491538644493732`*^9, 3.749153865833027*^9}}],

Cell[CellGroupData[{

Cell["4 loop running coupling", "Section",
 CellChangeTimes->{{3.733038025331724*^9, 3.733038035264956*^9}, {
  3.7330493983743973`*^9, 3.733049402685856*^9}, {3.73312956042422*^9, 
  3.733129564816101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"form", " ", "hep"}], "-", 
     RowBox[{"ph", " ", "9703284"}]}], ",", " ", "vermaseren", ",", " ", 
    "larin", ",", " ", "Ritbergen"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]QCD", "=", "0.2145"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"so", " ", "that", " ", "for", " ", "nF"}], "=", 
     RowBox[{
      RowBox[{"5", " ", "we", " ", "get", " ", "alpha_s", 
       RowBox[{"(", 
        RowBox[{"mz", "=", "91.188"}], ")"}]}], "=", 
      RowBox[{
       RowBox[{"0.1185", " ", 
        RowBox[{"(", 
         RowBox[{"PDG", " ", "value"}], ")"}], " ", "\[IndentingNewLine]", 
        "note", " ", "that", " ", "pdg", " ", "also", " ", "quotes", " ", 
        "\[Lambda]qcd"}], "=", 
       RowBox[{
        RowBox[{"0.214", " ", "for", " ", "nf"}], "=", 
        RowBox[{
        "5", " ", "everything", " ", "seems", " ", "consistent"}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "QCD", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nc", "=", "3."}], ";", 
    RowBox[{"CA", "=", "Nc"}], ";", " ", 
    RowBox[{"nF", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CF", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Nc", "2"], "-", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "Nc"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "coeft", " ", "of", " ", "the", " ", "renormalization", " ", "group", " ",
      "equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]0", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "11"}], "Nc"}], "+", 
        RowBox[{"2", "Nf"}]}], ")"}], "/", "12"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]1", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "68"}], 
         SuperscriptBox["Nc", "2"]}], "+", 
        RowBox[{"20", "Nc", " ", "Nf"}], "+", 
        RowBox[{"12", "CF", " ", "Nf"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"3", " ", "32"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]2", "[", "Nf_", "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2857", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"5033", "/", "9"}], ")"}], "Nf"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"325", "/", "27"}], ")"}], " ", 
           SuperscriptBox["Nf", "2"]}]}], ")"}], "/", "128"}], ")"}]}]}], 
    ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "Nc"}], "=", 
     RowBox[{"3", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]3", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "/", "256"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"149753", "/", "6"}], "+", 
          RowBox[{"3564", " ", 
           RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1078361", "/", "162"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"6508", "/", "27"}], ")"}], " ", 
            RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], "Nf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"50065", "/", "162"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"6472", "/", "81"}], ")"}], 
            RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], 
         SuperscriptBox["Nf", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1093", "/", "729"}], ")"}], " ", 
         SuperscriptBox["Nf", "3"]}]}], ")"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "Nc"}], "=", 
     RowBox[{"3", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]0", "[", "Nf_", "]"}], "=", 
     RowBox[{
      FractionBox["3", "4"], " ", "CF"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]1", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "16"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"202", "/", "3"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"20", "/", "9"}], ")"}], "Nf"}]}], ")"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "Nc"}], "=", 
     RowBox[{"3", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]2", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "64"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1249", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"2216", "/", "27"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"160", "/", "3"}], ")"}], " ", 
            RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], "Nf"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"140", "/", "81"}], ")"}], " ", 
         SuperscriptBox["Nf", "2"]}]}], ")"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"for", " ", "Nc"}], "=", 
     RowBox[{"3", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]3", "[", "Nf_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "256"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4603055", "/", "162"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"135680", "/", "27"}], ")"}], " ", 
         RowBox[{"Zeta", "[", "3", "]"}]}], "-", 
        RowBox[{"8800", 
         RowBox[{"Zeta", "[", "5", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"91723", "/", "27"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"34192", "/", "9"}], ")"}], " ", 
            RowBox[{"Zeta", "[", "3", "]"}]}], "+", 
           RowBox[{"880", " ", 
            RowBox[{"Zeta", "[", "4", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"18400", "/", "9"}], ")"}], 
            RowBox[{"Zeta", "[", "5", "]"}]}]}], ")"}], "Nf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5242", "/", "243"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"800", "/", "9"}], ")"}], " ", 
            RowBox[{"Zeta", "[", "3", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"160", "/", "3"}], ")"}], 
            RowBox[{"Zeta", "[", "4", "]"}]}]}], ")"}], 
         SuperscriptBox["Nf", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"332", "/", "243"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"64", "/", "27"}], ")"}], " ", 
            RowBox[{"Zeta", "[", "3", "]"}]}]}], ")"}], 
         SuperscriptBox["Nf", "3"]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b0", "[", "Nf_", "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", 
          RowBox[{"\[Beta]0", "[", "Nf", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "2"]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b1", "[", "Nf_", "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"32", " ", 
          RowBox[{"\[Beta]1", "[", "Nf", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]"}], ")"}], "2"]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Initial", " ", "conditions", " ", "of", " ", "the", " ", "RG", " ", 
      "equations"}], ",", " ", 
     RowBox[{
     "\[Mu]", " ", "in", " ", "units", " ", "of", " ", 
      "\[CapitalLambda]_MSbar"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"gf", "[", "\[Mu]_", "]"}], "=", 
      RowBox[{"1", "/", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "b0", " ", 
           RowBox[{"Log", "[", "\[Mu]", "]"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", "\[Mu]", "]"}]}], "]"}], "/", "b0"}]}]}], 
         ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gf", "[", "t_", "]"}], "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"b0", "[", "Nf", "]"}], " ", "t"}], "+", 
          RowBox[{
           RowBox[{"b1", "[", "Nf", "]"}], " ", 
           RowBox[{
            RowBox[{"Log", "[", "t", "]"}], "/", 
            RowBox[{"b0", "[", "Nf", "]"}]}]}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"asf", "[", 
      RowBox[{"t_", ",", "Nf_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]0", "[", "Nf", "]"}], " ", "t"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]1", "[", "Nf", "]"}], " ", 
         RowBox[{"Log", "[", "t", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"\[Beta]0", "[", "Nf", "]"}], "3"], " ", 
         SuperscriptBox["t", "2"]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Beta]1", "[", "Nf", "]"}], "2"], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Log", "[", "t", "]"}], "2"], "-", 
            RowBox[{"Log", "[", "t", "]"}], "-", "1"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"\[Beta]2", "[", "Nf", "]"}], " ", 
          RowBox[{"\[Beta]0", "[", "Nf", "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"\[Beta]0", "[", "Nf", "]"}], "5"], 
         SuperscriptBox["t", "3"]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"\[Beta]0", "[", "Nf", "]"}], "7"], 
           SuperscriptBox["t", "4"]}], ")"}]}], ")"}], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Beta]1", "[", "Nf", "]"}], "3"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"Log", "[", "t", "]"}], "3"]}], "+", 
            RowBox[{
             FractionBox["5", "2"], 
             SuperscriptBox[
              RowBox[{"Log", "[", "t", "]"}], "2"]}], "+", 
            RowBox[{"2", 
             RowBox[{"Log", "[", "t", "]"}]}], "-", 
            FractionBox["1", "2"]}], ")"}]}], "-", 
         RowBox[{"3", " ", 
          RowBox[{"\[Beta]1", "[", "Nf", "]"}], " ", 
          RowBox[{"\[Beta]2", "[", "Nf", "]"}], " ", 
          RowBox[{"\[Beta]0", "[", "Nf", "]"}], " ", 
          RowBox[{"Log", "[", "t", "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"\[Beta]3", "[", "Nf", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"\[Beta]0", "[", "Nf", "]"}], "2"]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]0", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t0", "=", 
     RowBox[{"Log", "[", 
      SuperscriptBox["\[Mu]0", "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tf", "=", 
     RowBox[{"10000", " ", "t0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "solution", " ", "of", " ", "the", " ", "RG", " ", "equation", " ", "to", 
     " ", "3", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mcharm", "=", "1.275"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"m", 
     RowBox[{"(", "m", ")"}], " ", "in", " ", "msbar"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mbottom", "=", "4.18"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nf", "[", "t_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "<", 
        RowBox[{"Log", "[", 
         RowBox[{
          SuperscriptBox["mcharm", "2"], "/", 
          SuperscriptBox["\[CapitalLambda]QCD", "2"]}], "]"}]}], ",", "3", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "<", 
          RowBox[{"Log", "[", 
           RowBox[{
            SuperscriptBox["mbottom", "2"], "/", 
            SuperscriptBox["\[CapitalLambda]QCD", "2"]}], "]"}]}], ",", "4", 
         ",", "5"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sg4", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"as", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{"+", 
              RowBox[{"\[Beta]0", "[", 
               RowBox[{"nf", "[", "t", "]"}], "]"}]}], " ", 
             SuperscriptBox[
              RowBox[{"as", "[", "t", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"\[Beta]1", "[", 
              RowBox[{"nf", "[", "t", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"as", "[", "t", "]"}], "3"]}], "+", " ", 
            RowBox[{
             RowBox[{"\[Beta]2", "[", 
              RowBox[{"nf", "[", "t", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"as", "[", "t", "]"}], "4"]}], "+", " ", 
            RowBox[{
             RowBox[{"\[Beta]3", "[", 
              RowBox[{"nf", "[", "t", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"as", "[", "t", "]"}], "5"]}]}]}], ",", 
          RowBox[{
           RowBox[{"as", "[", "tf", "]"}], "\[Equal]", 
           RowBox[{"asf", "[", 
            RowBox[{"tf", ",", 
             RowBox[{"nf", "[", "tf", "]"}]}], "]"}]}]}], "}"}], ",", "as", 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "t0", ",", "tf"}], "}"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "14"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "32"}], ",", 
        RowBox[{"MaxSteps", "\[Rule]", "10000000"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a4t", "[", "t_", "]"}], "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"as", "[", "t", "]"}], "/.", "sg4"}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g4", "[", "\[Mu]_", "]"}], "=", 
     RowBox[{"2", " ", "\[Pi]", " ", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"Part", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"as", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]", "2"], "/", 
              SuperscriptBox["\[CapitalLambda]QCD", "2"]}], "]"}], "]"}], "/.",
            "sg4"}], "]"}], ",", "1"}], "]"}]}]}]}], ";"}], " "}]}]], "Input",\

 CellChangeTimes->{{3.722603722510141*^9, 3.72260372344028*^9}, {
   3.722604106111541*^9, 3.722604106838868*^9}, {3.722758514249189*^9, 
   3.72275851575694*^9}, {3.722759338268147*^9, 3.7227593794887047`*^9}, 
   3.722941350741787*^9, 3.725272685733177*^9, {3.7257977704878893`*^9, 
   3.725797773117529*^9}, {3.728106253645876*^9, 3.728106267238208*^9}, {
   3.728106981843108*^9, 3.72810698836581*^9}, {3.728107035483563*^9, 
   3.728107083980345*^9}, {3.728107191150432*^9, 3.7281072205275097`*^9}, {
   3.7289260533327723`*^9, 3.728926057125319*^9}, {3.728926987957735*^9, 
   3.728927012966138*^9}, {3.733038068527727*^9, 3.733038137498209*^9}, {
   3.733038320612577*^9, 3.7330383210148697`*^9}, {3.7330540354197693`*^9, 
   3.7330540356914186`*^9}, {3.733129571506283*^9, 3.73312957588968*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.721037028308626*^9, 3.72103703898452*^9}, {
   3.725797990517199*^9, 3.725797994993998*^9}, {3.746174948979287*^9, 
   3.746174951979061*^9}, 3.7461750131323338`*^9, {3.748450442925918*^9, 
   3.748450454117791*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", "=", "20000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mc", "=", "1.4691897661033038`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mb", "=", "4.882"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kfinal", "=", 
    RowBox[{"{", 
     RowBox[{"0.6856700331366409`", ",", 
      RowBox[{"-", "0.31661256911352553`"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"100", "k", " ", "run"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kfinalu", "=", 
   RowBox[{"{", 
    RowBox[{"0.9065399936425322`", ",", 
     RowBox[{"-", "0.36858869824209667`"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kfinall", "=", 
   RowBox[{"{", 
    RowBox[{"0.4648000726307495`", ",", 
     RowBox[{"-", "0.2646364399849544`"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]cont", "=", 
   RowBox[{"{", 
    RowBox[{"0.5129548374487685`", ",", "0.002435119807500435`"}], "}"}]}], 
  ";", 
  RowBox[{"(*", 
   RowBox[{"10", "k", " ", "run"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]cont", "=", 
   RowBox[{"{", 
    RowBox[{"0.16999653850906107`", ",", "0.000838106749908169`"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccont", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1611740456186636`"}], ",", "0.002474788649682089`"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conv", "=", "0.197327"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReVsbVac", "=", 
   RowBox[{"8", "/", "10"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7512803928879557`*^9, 3.751280393946806*^9}}],

Cell[CellGroupData[{

Cell["Self energies", "Subsection",
 CellChangeTimes->{{3.748450427476173*^9, 3.748450462407011*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mDcalmu", "[", 
    RowBox[{"T_", ",", "\[Mu]_", ",", "c_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          FractionBox["Nc", "3"], "+", 
          FractionBox["nF", "6"], "+", 
          RowBox[{
           FractionBox["nF", 
            RowBox[{"2", 
             SuperscriptBox["\[Pi]", "2"]}]], 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Mu]", "/", "3"}], ")"}], "2"], 
            SuperscriptBox["T", "2"]]}]}], "]"}], 
        RowBox[{"g4", "[", 
         RowBox[{"2", "\[Pi]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["T", "2"], "+", 
            FractionBox[
             SuperscriptBox["\[Mu]", "2"], 
             SuperscriptBox["\[Pi]", "2"]]}]]}], "]"}], "T"}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"4", "\[Pi]"}]], "Nc", " ", 
        SuperscriptBox[
         RowBox[{"g4", "[", 
          RowBox[{"2", "\[Pi]", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["T", "2"], "+", 
             FractionBox[
              SuperscriptBox["\[Mu]", "2"], 
              SuperscriptBox["\[Pi]", "2"]]}]]}], "]"}], "2"], " ", "T", " ", 
        
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"Sqrt", "[", 
           RowBox[{
            FractionBox["Nc", "3"], "+", 
            FractionBox["nF", "6"]}], "]"}], 
          RowBox[{"g4", "[", 
           RowBox[{"2", "\[Pi]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["T", "2"], "+", 
              FractionBox[
               SuperscriptBox["\[Mu]", "2"], 
               SuperscriptBox["\[Pi]", "2"]]}]]}], "]"}]], "]"}]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"g4", "[", 
          RowBox[{"2", "\[Pi]", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["T", "2"], "+", 
             FractionBox[
              SuperscriptBox["\[Mu]", "2"], 
              SuperscriptBox["\[Pi]", "2"]]}]]}], "]"}], "2"], " ", "T"}], 
       "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"g4", "[", 
          RowBox[{"2", "\[Pi]", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["T", "2"], "+", 
             FractionBox[
              SuperscriptBox["\[Mu]", "2"], 
              SuperscriptBox["\[Pi]", "2"]]}]]}], "]"}], "3"], "T"}]}], " ", 
      "]"}], ",", "30"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74845188564533*^9, 3.7484518857590313`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPi]per", "[", 
    RowBox[{
    "\[Theta]_", ",", "\[Phi]_", ",", "\[Beta]_", ",", "mD_", ",", "u_"}], 
    "]"}], ":=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["mD", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "-", 
          RowBox[{"2", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["u", "4"], 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["u", "2"], "+", 
            RowBox[{
             SuperscriptBox["u", "2"], 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "2"]], 
        "-", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", 
             SuperscriptBox["u", "2"], "-", 
             RowBox[{
              SuperscriptBox["u", "2"], 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["u", "2"]}], ")"}], "u", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["u", "2"], "+", 
              RowBox[{
               SuperscriptBox["u", "2"], 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
            RowBox[{"5", "/", "2"}]]}]], 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"u", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["u", "2"], "+", 
              RowBox[{
               SuperscriptBox["u", "2"], 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
           RowBox[{
            RowBox[{"u", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["u", "2"], "+", 
              RowBox[{
               SuperscriptBox["u", "2"], 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]", "-", "\[Beta]"}], "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]]}]], 
          "]"}]}]}], ")"}]}], ",", "30"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749707366461025*^9, 3.749707369202869*^9}, {
  3.749707435716299*^9, 3.749707644142868*^9}, {3.74970771591074*^9, 
  3.749707722806602*^9}, {3.7497083379937363`*^9, 3.7497083380887413`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["IIT paper", "Subsection",
 CellChangeTimes->{{3.7484504686955633`*^9, 3.7484504994467287`*^9}, {
   3.748450538599163*^9, 3.748450542903339*^9}, 3.7484506025366297`*^9}],

Cell[CellGroupData[{

Cell["Permittivities", "Subsubsection",
 CellChangeTimes->{{3.748450869220883*^9, 3.748450881592766*^9}, {
  3.748450915542739*^9, 3.7484509164068193`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]Imp", "[", 
    RowBox[{"r_", ",", "mD_", ",", "u_", ",", "T_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
    RowBox[{"Quiet", "[", 
     RowBox[{"Re", "[", 
      RowBox[{"T", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["u", "2"], "-", 
              RowBox[{
               SuperscriptBox["u", "2"], 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]", "-", "0"}], "]"}], "2"]}]}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["u", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], 
           RowBox[{"2", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["u", "2"], "+", 
               RowBox[{
                SuperscriptBox["u", "2"], 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Phi]", "-", "0"}], "]"}], "2"]}]}], ")"}], 
             RowBox[{"5", "/", "2"}]]}]], 
          FractionBox[
           SuperscriptBox["mD", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalPi]per", "[", 
              RowBox[{
              "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", "u"}], 
              "]"}], "-", 
             RowBox[{"Conjugate", "[", 
              RowBox[{"\[CapitalPi]per", "[", 
               RowBox[{
               "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", "u"}], 
               "]"}], "]"}]}], ")"}]], 
          FractionBox["1", "r"], 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SqrtBox[
              RowBox[{"Conjugate", "[", 
               RowBox[{"\[CapitalPi]per", "[", 
                RowBox[{
                "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", "u"}], 
                "]"}], "]"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"CoshIntegral", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Cosh", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
                RowBox[{"SinhIntegral", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}]}], ")"}]}],
             "+", 
            RowBox[{"r", " ", 
             RowBox[{"Conjugate", "[", 
              RowBox[{"\[CapitalPi]per", "[", 
               RowBox[{
               "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", "u"}], 
               "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cosh", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
                RowBox[{"CoshIntegral", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Sinh", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], " ", 
                RowBox[{"SinhIntegral", "[", 
                 RowBox[{"r", " ", 
                  SqrtBox[
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}], "]"}]], " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]}]}], ")"}]}],
             "+", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[CapitalPi]per", "[", 
               RowBox[{
               "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", "u"}], 
               "]"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"CoshIntegral", "[", 
                  RowBox[{"r", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                   SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"r", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                   RowBox[{"Cosh", "[", 
                    RowBox[{"r", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}], " ", 
                   SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"r", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"Cosh", "[", 
                    RowBox[{"r", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                   SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]], " ", 
                   RowBox[{"Sinh", "[", 
                    RowBox[{"r", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    SqrtBox[
                    RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}]}]}], ")"}], " ", 
                RowBox[{"SinhIntegral", "[", 
                 RowBox[{"r", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                  SqrtBox[
                   RowBox[{"\[CapitalPi]per", "[", 
                    RowBox[{
                    "\[Theta]", ",", "\[Phi]", ",", "0", ",", "mD", ",", 
                    "u"}], "]"}]]}], "]"}]}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "20"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "1"}]}], "]"}]}], "]"}], 
     "]"}]}]}], ";", 
  RowBox[{"(*", "UNREGULATED", "*)"}]}]], "Input",
 CellChangeTimes->{{3.74845092703507*^9, 3.748450937685601*^9}, {
   3.7489433167977753`*^9, 3.748943332355961*^9}, {3.7489433646776752`*^9, 
   3.7489433741412687`*^9}, {3.748943423038916*^9, 3.748943440837915*^9}, 
   3.749188428401885*^9, {3.7497089098283443`*^9, 3.749708923236423*^9}, {
   3.7497091774322777`*^9, 3.749709212211916*^9}, {3.7497092493751917`*^9, 
   3.749709257229188*^9}, {3.749709316478237*^9, 3.749709316685458*^9}, {
   3.7497093806393633`*^9, 3.7497093807583437`*^9}, {3.749709480016882*^9, 
   3.749709480118947*^9}, {3.749709892472438*^9, 3.7497098951298313`*^9}, {
   3.7497099353614264`*^9, 3.749710025988022*^9}, {3.751270699080003*^9, 
   3.751270702968403*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]Imp", "[", 
   RowBox[{"50", ",", 
    RowBox[{"5", "/", "10"}], ",", 
    RowBox[{"99", "/", "100"}], ",", 
    RowBox[{"250", "/", "1000"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",\

 CellChangeTimes->{{3.749710091584497*^9, 3.749710095808035*^9}, {
   3.749710156714964*^9, 3.749710177721519*^9}, 3.751270636552683*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,43,1,16077779313552877036,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7512706424226303`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"49.290709`", ",", "1.03337740607239592143859737455049`20.*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.749710080931025*^9, 3.749710087157942*^9}, {
   3.749710154552318*^9, 3.749710194442861*^9}, 3.7512706885092487`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tabs", "Subsection",
 CellChangeTimes->{{3.74845078759194*^9, 3.748450827213127*^9}, 
   3.748451123843587*^9, 3.748941360059739*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImVsTab", "[", 
    RowBox[{"mD1_", ",", "u1_", ",", "\[Sigma]1_", ",", "T1_"}], "]"}], ":=", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "=", "u1"}], ",", 
       RowBox[{"mD", "=", "mD1"}], ",", 
       RowBox[{"\[Sigma]", "=", "\[Sigma]1"}], ",", 
       RowBox[{"T", "=", "T1"}], ",", "tab0", ",", "tab1", ",", "inter0", ",",
        "inter1", ",", "inter2", ",", "temp", ",", "tab2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"tab0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"4", "\[Pi]", " ", "\[Sigma]", " ", 
            SuperscriptBox["r", "2"], 
            RowBox[{"\[Epsilon]Imp", "[", 
             RowBox[{"r", ",", "mD", ",", "u", ",", "T"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]], ",", "50", ",", 
           RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inter0", "=", 
       RowBox[{"Interpolation", "[", "tab0", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inter1", "[", "r_", "]"}], ":=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"inter0", "[", "r1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r1", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "10"}]], ",", "r"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{"inter1", "[", 
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tab1", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{
            RowBox[{"inter1", "[", "r", "]"}], "-", "temp"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]], ",", "50", ",", 
           RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inter1", "=", 
       RowBox[{"Interpolation", "[", "tab1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inter2", "[", "r_", "]"}], ":=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"inter1", "[", "r1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r1", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "10"}]], ",", "r"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tab2", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"inter2", "[", "r", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]], ",", "50", ",", 
           RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"\"\<vel_pot_perp/ImVsu\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"100", " ", "u"}], "]"}], "]"}], "<>", 
         "\"\<T250.dat\>\""}], ",", "tab2"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7453831005455914`*^9, 3.745383138661728*^9}, {
   3.745383312376183*^9, 3.74538334437337*^9}, {3.7453836903426113`*^9, 
   3.745383700509996*^9}, {3.745383888049996*^9, 3.7453838920497932`*^9}, {
   3.745384456942053*^9, 3.745384462717682*^9}, {3.745385041376384*^9, 
   3.7453850447607927`*^9}, {3.745385110730214*^9, 3.745385155644156*^9}, {
   3.745385388111433*^9, 3.745385411593401*^9}, {3.7453875595914288`*^9, 
   3.745387568075132*^9}, 3.745389177212406*^9, {3.7453901984733753`*^9, 
   3.745390202887982*^9}, {3.745390355427387*^9, 3.745390388219348*^9}, {
   3.7453977096680326`*^9, 3.745397725914731*^9}, {3.745397755948641*^9, 
   3.745397756084126*^9}, {3.7453980995991077`*^9, 3.745398113870977*^9}, {
   3.745399156102378*^9, 3.745399178169222*^9}, {3.745399342881937*^9, 
   3.745399361912752*^9}, {3.745401796965457*^9, 3.7454018195641527`*^9}, {
   3.745401971762494*^9, 3.745401971914714*^9}, {3.745404041771303*^9, 
   3.745404151470154*^9}, {3.745404384229478*^9, 3.745404389436048*^9}, {
   3.7454045122009163`*^9, 3.7454045237036552`*^9}, {3.745404614275045*^9, 
   3.7454046169752293`*^9}, {3.745404890358831*^9, 3.745404914872879*^9}, {
   3.7454740207870693`*^9, 3.745474024498345*^9}, {3.745477052572796*^9, 
   3.745477084925427*^9}, {3.745583208377653*^9, 3.74558321316575*^9}, {
   3.7461777044683733`*^9, 3.746177794182501*^9}, {3.746360152439383*^9, 
   3.746360194120142*^9}, 3.747138517796213*^9, {3.74714032667677*^9, 
   3.747140456145793*^9}, {3.747142006921813*^9, 3.7471420095970497`*^9}, {
   3.7471420459327374`*^9, 3.747142070011909*^9}, {3.747142963611829*^9, 
   3.7471429679068823`*^9}, {3.747329490809226*^9, 3.7473294977769136`*^9}, {
   3.747458708309948*^9, 3.747458716523738*^9}, {3.747458783591525*^9, 
   3.747458787423175*^9}, {3.747458847768239*^9, 3.747458887920331*^9}, {
   3.747458940561996*^9, 3.747458944633296*^9}, {3.7474592066074753`*^9, 
   3.74745921250218*^9}, {3.747459387579301*^9, 3.747459391009719*^9}, {
   3.748450903768133*^9, 3.748450907542585*^9}, {3.7484510000627728`*^9, 
   3.748451033580184*^9}, {3.748456282411323*^9, 3.7484562828912697`*^9}, {
   3.748456340716448*^9, 3.748456344192161*^9}, {3.748456392965889*^9, 
   3.748456393348927*^9}, {3.748456492880068*^9, 3.748456541864429*^9}, {
   3.748456593905673*^9, 3.748456610377811*^9}, {3.749153597093884*^9, 
   3.749153621958075*^9}, {3.749153935907349*^9, 3.749153941020252*^9}, {
   3.749187135207795*^9, 3.74918713553677*^9}, {3.749581856519682*^9, 
   3.749581857664353*^9}, {3.749612630887063*^9, 3.7496126481429253`*^9}, {
   3.749659264625359*^9, 3.749659265160788*^9}, {3.749709838636956*^9, 
   3.74970984278293*^9}, {3.7497144410793867`*^9, 3.7497144462364817`*^9}, 
   3.749838442112775*^9, 3.749838516497767*^9, {3.749838651484379*^9, 
   3.7498386815391607`*^9}, {3.7512707131040277`*^9, 3.7512707300573397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make potentials", "Subsection",
 CellChangeTimes->{{3.745471833598156*^9, 3.745471838992208*^9}, {
  3.747482702323744*^9, 3.747482702739996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uscan", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"1", "/", "10"}], ",", 
        RowBox[{"9", "/", "10"}], ",", 
        RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"99", "/", "100"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.749612678485621*^9, 3.7496126878892603`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "10"], ",", 
   FractionBox["1", "5"], ",", 
   FractionBox["3", "10"], ",", 
   FractionBox["2", "5"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["3", "5"], ",", 
   FractionBox["7", "10"], ",", 
   FractionBox["4", "5"], ",", 
   FractionBox["9", "10"], ",", 
   FractionBox["99", "100"]}], "}"}]], "Output",
 CellChangeTimes->{3.749612689354959*^9, 3.749646562747159*^9, 
  3.7496557274840384`*^9, 3.7496592468425207`*^9, 3.7496593187475977`*^9, 
  3.749710347675283*^9, 3.749766872236038*^9, 3.749838451879291*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"ImVsTab", "[", 
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"mDcalmu", "[", 
       RowBox[{"0.155", ",", "0", ",", 
        RowBox[{"kfinal", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"kfinal", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "30"}], "]"}], ",", 
    RowBox[{"uscan", "[", 
     RowBox[{"[", "10", "]"}], "]"}], ",", 
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"\[Sigma]cont", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "30"}], "]"}], ",", 
    RowBox[{"155", "/", "1000"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.74983867461902*^9, 3.749838674730877*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 191, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[774, 28, 207, 3, 64, "Section"],
Cell[984, 33, 17342, 501, 1007, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18363, 539, 267, 4, 50, "Section"],
Cell[18633, 545, 1680, 49, 243, "Input"],
Cell[CellGroupData[{
Cell[20338, 598, 101, 1, 44, "Subsection"],
Cell[20442, 601, 2687, 80, 187, "Input"],
Cell[23132, 683, 4224, 112, 187, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27393, 800, 175, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[27593, 806, 156, 2, 35, "Subsubsection"],
Cell[27752, 810, 11174, 259, 508, "Input"],
Cell[CellGroupData[{
Cell[38951, 1073, 372, 9, 32, "Input"],
Cell[39326, 1084, 373, 8, 24, "Message"],
Cell[39702, 1094, 266, 5, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40029, 1106, 139, 2, 44, "Subsection"],
Cell[40171, 1110, 6386, 135, 238, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46594, 1250, 152, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[46771, 1256, 455, 13, 32, "Input"],
Cell[47229, 1271, 588, 15, 45, "Output"]
}, Open  ]],
Cell[47832, 1289, 727, 19, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

